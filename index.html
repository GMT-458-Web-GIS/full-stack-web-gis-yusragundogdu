<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudentRadar - National Cost Map</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v8.2.0/ol.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700&display=swap" rel="stylesheet">
    
    <style>
        /* Sƒ∞YAH TEMALI TASARIM */
        body { margin: 0; padding: 0; font-family: 'Inter', sans-serif; display: flex; height: 100vh; background-color: #050505; color: #e0e0e0; overflow: hidden; }
        
        /* SOL PANEL */
        #sidebar {
            width: 360px; background-color: #121212; padding: 30px;
            box-shadow: 5px 0 30px rgba(0,0,0,0.5); display: flex; flex-direction: column; z-index: 10; border-right: 1px solid #222;
        }

        .brand-title { font-size: 32px; font-weight: 800; color: #ff9800; margin-bottom: 5px; letter-spacing: -1px; }
        .brand-subtitle { font-size: 13px; color: #666; margin-bottom: 40px; text-transform: uppercase; letter-spacing: 2px; font-weight: 600; }

        .stats-container { display: flex; flex-direction: column; gap: 15px; margin-bottom: auto; }
        .stat-card {
            background: #1a1a1a; padding: 25px; border-radius: 12px;
            border: 1px solid #333; display: flex; justify-content: space-between; align-items: center;
            transition: 0.3s; position: relative; overflow: hidden;
        }
        .stat-card::before { content:''; position: absolute; left: 0; top: 0; bottom: 0; width: 6px; background: #444; }
        .stat-card.orange::before { background: #ff9800; }
        .stat-card.green::before { background: #4caf50; }
        .stat-card.blue::before { background: #2196F3; }
        
        .stat-info h4 { margin: 0 0 5px 0; font-size: 11px; color: #888; text-transform: uppercase; letter-spacing: 1px; }
        .stat-info span { font-size: 28px; font-weight: 700; color: #fff; }

        /* HARƒ∞TA ALANI (Sƒ∞MSƒ∞YAH) */
        #map { flex-grow: 1; height: 100%; background-color: #050505; position: relative; }

        /* TOOLTIP */
        #tooltip {
            position: absolute;
            background: rgba(20, 20, 20, 0.95);
            border: 1px solid #ff9800;
            border-radius: 8px;
            padding: 20px;
            color: white;
            pointer-events: none;
            display: none;
            z-index: 1000;
            width: 220px;
            box-shadow: 0 20px 50px rgba(0,0,0,1);
            backdrop-filter: blur(10px);
        }
        #tooltip h3 { margin: 0 0 15px 0; font-size: 18px; color: #ff9800; border-bottom: 1px solid #444; padding-bottom: 10px; }
        .tooltip-row { display: flex; justify-content: space-between; font-size: 14px; margin-bottom: 8px; color: #bbb; }
        .tooltip-row b { color: white; }

        /* Gƒ∞Rƒ∞≈û MODAL */
        .modal {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: #181818; padding: 40px; border-radius: 16px; border: 1px solid #333;
            width: 320px; display: none; z-index: 2000; box-shadow: 0 50px 100px rgba(0,0,0,1); text-align: center;
        }
        .modal input { width: 100%; padding: 15px; margin-bottom: 15px; background: #222; border: 1px solid #333; color: white; border-radius: 8px; box-sizing: border-box; font-size: 14px; outline: none; }
        .modal input:focus { border-color: #ff9800; }
        .modal button { width: 100%; padding: 15px; background: #ff9800; border: none; font-weight: bold; border-radius: 8px; cursor: pointer; color: black; font-size: 14px; }
        
        /* BUTONLAR */
        #auth-panel { padding-top: 20px; border-top: 1px solid #222; }
        .main-btn { width: 100%; padding: 15px; border-radius: 8px; border: none; font-weight: bold; cursor: pointer; text-transform: uppercase; letter-spacing: 1px; font-size: 12px; transition: 0.2s; }
        .btn-login { background: #ff9800; color: black; }
        .btn-logout { background: #d32f2f; color: white; display: none; }
        
    </style>
</head>
<body>

    <div id="sidebar">
        <div class="brand-title">StudentRadar</div>
        <div class="brand-subtitle">National Living Cost Index</div>

        <div class="stats-container">
            <div class="stat-card orange">
                <div class="stat-info">
                    <h4>Avg. Rent</h4>
                    <span id="global-rent">‚Ç∫8,450</span>
                </div>
            </div>
            <div class="stat-card green">
                <div class="stat-info">
                    <h4>Avg. Coffee</h4>
                    <span id="global-coffee">‚Ç∫52.00</span>
                </div>
            </div>
            <div class="stat-card blue">
                <div class="stat-info">
                    <h4>Transport</h4>
                    <span id="global-trans">‚Ç∫14.50</span>
                </div>
            </div>
        </div>
        
        <div id="auth-panel">
            <p id="user-status" style="font-size: 11px; color: #666; text-align: center; margin-bottom: 10px;">GUEST VIEW</p>
            <button class="main-btn btn-login" onclick="document.getElementById('login-modal').style.display='block'">Login to Contribute</button>
            <button class="main-btn btn-logout" onclick="logout()">Logout</button>
        </div>
    </div>

    <div id="map"></div>

    <div id="tooltip">
        <h3 id="tt-name">City Name</h3>
        <div class="tooltip-row"><span>üè† Rent:</span> <b id="tt-rent">--</b></div>
        <div class="tooltip-row"><span>‚òï Coffee:</span> <b id="tt-coffee">--</b></div>
        <div class="tooltip-row"><span>üöå Bus:</span> <b id="tt-trans">--</b></div>
    </div>

    <div id="login-modal" class="modal">
        <h2 style="color:#ff9800; margin-top:0;">System Login</h2>
        <input type="text" id="username" placeholder="Username">
        <input type="password" id="password" placeholder="Password">
        <button onclick="login()">ACCESS DASHBOARD</button>
        <p style="color:#666; font-size:12px; margin-top:15px; cursor:pointer;" onclick="document.getElementById('login-modal').style.display='none'">Close</p>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/ol@v8.2.0/dist/ol.js"></script>
    <script>
        // 1. HARƒ∞TA ZEMƒ∞Nƒ∞
        const map = new ol.Map({
            target: 'map',
            layers: [], 
            view: new ol.View({
                center: ol.proj.fromLonLat([35.2433, 39.0]), // T√ºrkiye Merkezi
                zoom: 6.5,
                minZoom: 5,
                maxZoom: 9
            })
        });

        // 2. SENƒ∞N ƒ∞NDƒ∞RDƒ∞ƒûƒ∞N 'turkey.geojson' DOSYASINI OKU
        const vectorSource = new ol.source.Vector({
            url: './turkey.geojson',  // BURAYI D√úZELTTƒ∞K ‚úÖ
            format: new ol.format.GeoJSON()
        });

        // Veri olan iller (Sim√ºlasyon)
        const activeCities = ["Ankara", "Istanbul", "Izmir", "Eskisehir", "Antalya", "Bursa", "Trabzon", "Konya", "Adana", "Gaziantep"];

        // 3. STƒ∞L AYARLARI
        const styleFunction = function(feature) {
            // GeoJSON dosyasƒ±ndaki isim √∂zelliƒüini al
            // Dosyaya g√∂re 'name', 'Name', 'NAME' olabilir. Genelde 'name'dir.
            const name = feature.get('name') || feature.get('Name') || "Unknown";
            
            // ƒ∞smi standartla≈ütƒ±r (T√ºrk√ße karakter sorunu olmasƒ±n diye basit kontrol)
            const isActive = activeCities.some(city => name.includes(city));

            return new ol.style.Style({
                fill: new ol.style.Fill({
                    // Veri varsa Turuncu, yoksa Koyu Gri
                    color: isActive ? 'rgba(255, 152, 0, 0.9)' : 'rgba(40, 40, 40, 1)'
                }),
                stroke: new ol.style.Stroke({
                    color: '#111', 
                    width: 1
                }),
                text: new ol.style.Text({
                    text: name,
                    font: '10px Inter',
                    fill: new ol.style.Fill({ color: isActive ? '#000' : '#666' }),
                    stroke: new ol.style.Stroke({ color: isActive ? 'rgba(255,255,255,0.8)' : '#000', width: 2 })
                })
            });
        };

        const vectorLayer = new ol.layer.Vector({
            source: vectorSource,
            style: styleFunction
        });
        map.addLayer(vectorLayer);

        // 4. MOUSE HOVER (TOOLTIP)
        const tooltip = document.getElementById('tooltip');
        
        map.on('pointermove', function(evt) {
            if (evt.dragging) return;
            
            const feature = map.forEachFeatureAtPixel(evt.pixel, function(f) { return f; });

            if (feature) {
                const name = feature.get('name') || feature.get('Name');
                const isActive = activeCities.some(city => name.includes(city));

                document.getElementById('tt-name').innerText = name;

                if(isActive) {
                    document.getElementById('tt-rent').innerText = '‚Ç∫' + (Math.floor(Math.random()*5000) + 5000);
                    document.getElementById('tt-coffee').innerText = '‚Ç∫' + (Math.floor(Math.random()*40) + 30);
                    document.getElementById('tt-trans').innerText = '‚Ç∫' + (Math.floor(Math.random()*10) + 10);
                } else {
                    document.getElementById('tt-rent').innerText = 'No Data';
                    document.getElementById('tt-coffee').innerText = '--';
                    document.getElementById('tt-trans').innerText = '--';
                }

                tooltip.style.display = 'block';
                tooltip.style.left = (evt.pixel[0] + 20) + 'px';
                tooltip.style.top = (evt.pixel[1] + 20) + 'px';
                map.getTargetElement().style.cursor = 'pointer';
            } else {
                tooltip.style.display = 'none';
                map.getTargetElement().style.cursor = '';
            }
        });

        // 5. LOGIN Sƒ∞STEMƒ∞
        function login() {
            document.getElementById('login-modal').style.display = 'none';
            document.querySelector('.btn-login').style.display = 'none';
            document.querySelector('.btn-logout').style.display = 'block';
            document.getElementById('user-status').innerText = "LOGGED IN: ADMIN";
            document.getElementById('user-status').style.color = "#ff9800";
            alert("Login Successful! Dashboard unlocked.");
        }
        function logout() {
            document.querySelector('.btn-login').style.display = 'block';
            document.querySelector('.btn-logout').style.display = 'none';
            document.getElementById('user-status').innerText = "GUEST VIEW";
            document.getElementById('user-status').style.color = "#666";
        }
    </script>
</body>
</html>